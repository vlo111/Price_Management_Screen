<!-- MAIN CONTENT -->
<div id="content">
    <div class="col-xs-12 col-sm-7 col-md-7 col-lg-4">
        <h1 class="page-title txt-color-blueDark">
            <i class="fa-fw fa fa-truck"></i>
            Orders
            <span>
                >
                Subtitle
            </span>
        </h1>
    </div>
    <section id="widget-grid" class="">
        <div class="row">

            <article class="col-sm-12">
                <!-- Filter Section -->
                <div class="col-sm-12 col-md-12 col-lg-12">
                    <div class="jarviswidget  jarviswidget-color-darken" id="wid-id-2" data-widget-colorbutton="false" data-widget-editbutton="false" data-widget-togglebutton="false"
                         data-widget-deletebutton="false"
                         data-widget-fullscreenbutton="false"
                         data-widget-custombutton="false"
                         data-widget-collapsed="false"
                         data-widget-sortable="false" role="widget">

                        <!-- widget div-->
                        <header role="heading">
                            <h2 class="font-md"><strong>Filter</strong></h2>
                            <span class="jarviswidget-loader"><i class="fa fa-refresh fa-spin"></i></span>
                        </header>
                        <div role="content">
                            <div class="row">
                                <div class="form-horizontal">
                                    <div class="form-group">
                                        <label class="control-label col-sm-3">Company</label>
                                        <div class="col-sm-4">
                                            <select class="form-control" id="TagGroup">
                                                <option value="0">Select</option>
                                                <option value="1">Alexandra</option>
                                                <option value="2">Alice</option>
                                                <option value="3">Anastasia</option>
                                                <option value="4">Avelina</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="control-label col-sm-3" for="TagGroup">State</label>
                                        <div class="col-sm-4">
                                            <select class="form-control" id="TagGroup">
                                                <option value="0">Select</option>
                                                <option value="1">Alexandra</option>
                                                <option value="2">Alice</option>
                                                <option value="3">Anastasia</option>
                                                <option value="4">Avelina</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- end widget div -->
                    </div>
                </div>
                <!-- Filter Section End -->
            </article>

        </div>
    </section>
    <section id="widget-grid" class="">
        <!-- START ROW -->
        <div class="row">
            <article class="col-sm-12">
                <!-- NEW COL START -->
                <div class="col-sm-12 col-md-12 col-lg-12">
                    <!-- Customer Div-->
                    <div class="jarviswidget  jarviswidget-color-darken" id="wid-id-2" data-widget-colorbutton="false" data-widget-editbutton="false" data-widget-togglebutton="false"
                         data-widget-deletebutton="false"
                         data-widget-fullscreenbutton="false"
                         data-widget-custombutton="false"
                         data-widget-collapsed="false"
                         data-widget-sortable="false" role="widget">

                        <!-- widget div-->
                        <header role="heading">
                            <h2 class="font-md"><strong>Orders</strong></h2>
                            <span class="jarviswidget-loader"><i class="fa fa-refresh fa-spin"></i></span>
                        </header>
                        <div role="content">
                            <div class="orderDetailPanel" id="allOrdersSection">
                                <div class="widget-body no-padding">
                                    <div class="tab-content padding-10">
                                        <div class="tab-pane fade active in" id="AllParts">
                                            <div class="padding-10">
                                                <table id="OrdersList" class="table table-striped table-bordered table-hover"></table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- end widget div -->
                    </div>
                </div>
                <!-- END COL -->
            </article>
        </div>
        <!-- END ROW -->
    </section>
    <input type="hidden" id="customerId" value="@ViewBag.CustomerId"/>
</div>
<!-- END MAIN CONTENT -->


<style>
    .orderDetailPanel {
        display: -webkit-box;
        display: -webkit-flex;
        display: -ms-flexbox;
        display: flex;
    }

        .orderDetailPanel > div {
            margin: 0px 5px 15px 0px;
        }

        .orderDetailPanel .dropFile {
            overflow-y: scroll;
            max-height: 200px;
        }

    .tagDropDown {
        max-width: inherit;
        padding: 2px;
        color: #000;
    }

    .tagPanel {
        padding: 5px;
        border-radius: 5px;
    }

    #tagSection .active table thead {
        color: #000;
    }

    #tagSection .active {
        border-radius: 5px;
        border-color: #3276b1;
        color: #fff;
        background-color: #337ab7;
    }

    .tagLabel {
        padding: 0px 10px;
    }

    .dataTables_scrollHeadInner {
        width: 100% !important;
    }

    #OrdersList {
        width: 100% !important;
    }
</style>


@section pagespecific {

    <script>
        var attendeeUrl = '@Url.Action("GetItems", "Order")';
        var pageSize = 20;
        function tagHtml() { }

        function removePartFrmTag(cntrl) {
            alert(this)
            $(cntrl).closest('tr').remove();

        }

        var responsiveHelper_datatable_tabletools = undefined;
        var responsiveHelper = undefined;
        var breakpointDefinition = {
            tablet: 1024,
            phone: 480
        };

        function editPart() { }
        function addPartInTag() { }
        function customPart() { }
    </script>

    <script>
       

        function addPartItem(itemId) {
            var attendeeUrl = '@Url.Action("GetPartAgainstId", "Order")';
            var counter = 0;
            $.ajax({
                url: attendeeUrl,
                dataType: 'json',
                delay: 250,
                type: 'GET',
                data: { partId: itemId },


                success: function (responseResult) {
                    //Used to determine whether or not there are more results available,
                    //and if requests for more data should be sent in the infinite scrolling
                    console.log(responseResult);
                    $.each(responseResult, function (index, item) {
                        drawRowinDT(item);
                    });
                },
                cache: true
            });

        }
        function drawRowinDT(data) {
            ordersTable.row.add([
                0 + '.1',
                data.categoryID,
                data.partID,
                data.image,
                data.image,
                data.description,
                data.prices,
                data.comments,
                data.weightMeasurement,
                data.weightMeasurement,
                data.weight,
                data.partID,
                data.files

            ]).draw(false);
        }


        var clientTable = $('#OrdersList').DataTable({
            serverSide: true,
            //ajax: appRoot + "Dashboard/GetCustomerOrders",
            "ajax": {
                "url": appRoot + "Dashboard/GetCustomerOrders",
                "type": 'GET',
                "data": function (d) {
                    d.customerId = $('#customerId').val();

                },
                "dataSrc": function (json) {
                    // manipulate your data (json)
                    return json.data;
                }
            },
            "bFilter": false,
            "bLengthChange": false,
            "bInfo": false,
            "type": 'GET',

            "columnDefs": [{
                "searchable": false,
                "orderable": false,
                "targets": 0
            }],
            "order": [[1, 'asc']],
            columns: [
                {
                    name: 'CustOrderID',
                    data: 'custOrderID',
                    title: "Order ID",
                    sortable: true,
                    searchable: true,
                    render: function (data, type, row) {
                        if (type === 'display') {
                            return '<a href="javascript:void(0);"  title=" Edit" onclick="viewOrder(' + data + ');">' + data + '</a> '
                        }
                        return data;
                    }
                },

                {
                    name: 'companyName',
                    data: "customer.company",
                    title: "Company",
                    sortable: true,
                    searchable: true
                },
                {
                    name: 'image',
                    data: "revision",
                    title: "State",
                    sortable: true,
                    searchable: true
                },
                {
                    name: 'employeeName',
                    data: "employee.firstName",
                    title: "Employee",
                    sortable: true,
                    searchable: true,
                    "render": function (data, type, full, meta) {
                        return full.employee.firstName + " " + full.employee.lastName;
                    }
                },
                {
                    name: 'createdDate',
                    data: "createdDate",
                    title: "Date Create",
                    sortable: true,
                    searchable: true,
                    "render": function (data, type, full, meta) {
                        return new Date(data).toLocaleString();
                    }
                },
                {
                    name: 'custOrderID',
                    data: "custOrderID",
                    title: "Action",
                    sortable: false,
                    searchable: false,
                    render: function (data, type, row) {
                        if (type === 'display') {

                            return '<a href="javascript:void(0);" title=" Edit" onclick="viewOrder(' + data + ');"> View </a> ';
                        }
                        return data;
                    }
                }
            ],
            "scrollX": true,
            "oLanguage": {
                "sSearch": ""
            },
            //dom: "<'dt-toolbar'<'col-xs-12 col-sm-5 col-md-2 col-lg-2'B><'col-xs-12 col-sm-5 col-md-5 col-lg-5 'f><'hidden-sm hidden-xs col-md-2 col-lg-2 pull-right'l>r>" +
            //"t" +
            //"<'dt-toolbar-footer'<'col-sm-6 col-xs-12 hidden-xs'i><'col-sm-6 col-xs-12'p>>",
            buttons: [
                {
                    className: "category-select",
                    text: '',
                    action: function (e, dt, node, config) {
                        alert('Button activated');
                    }
                }

            ],
            initComplete: function () {
                $('.category-select').parent().html(' <section>' +

                    '<label class="select" > ' +
                    '<select class="input-sm" id= "CategorySearchDDL" > ' +
                    '<option value= "0" selected> Select Category </option > ' +
                    '<option value= "1" > Alexandra</option > ' +
                    '<option value= "2" > Alice</option > ' +
                    '<option value= "3" > Anastasia</option > ' +
                    '<option value= "4" > Avelina</option > ' +
                    '   </select >' +
                    '</label > ' +
                    '</section >')
                $('.dataTables_filter input').attr("placeholder", "Find by product ID or Description");
                $('.dataTables_filter input').css("min-width", "250px");
            },
            "autoWidth": true,
            "preDrawCallback": function () {
                // Initialize the responsive datatables helper once.
                if (!responsiveHelper) {
                    responsiveHelper = new ResponsiveDatatablesHelper($('#OrdersList'), breakpointDefinition);
                }
            },
            "rowCallback": function (nRow) {
                responsiveHelper.createExpandIcon(nRow);
            },
            "drawCallback": function (oSettings) {
                responsiveHelper.respond();
            }
        });
        
        function viewOrder(custOrderID) {
            window.location.href = appRoot + "Order/View/" + custOrderID;
        }
    </script>
    <script type="text/javascript">
        // PAGE RELATED SCRIPTS

        // pagefunction

        var pagefunction = function () {

            Dropzone.autoDiscover = false;
            $("#mydropzone").dropzone({
                //url: "/file/post",
                addRemoveLinks: true,
                maxFilesize: 0.5,
                dictDefaultMessage: '<span class="text-center"><span class="font-lg visible-xs-block visible-sm-block visible-lg-block"><span class="font-lg"><i class="fa fa-caret-right text-danger"></i> Drop files <span class="font-xs">to upload</span></span><span>&nbsp&nbsp<h4 class="display-inline"> (Or Click)</h4></span>',
                dictResponseError: 'Error uploading file!'
            });

            //File Upload response from the server
            Dropzone.options.dropzoneForm = {
                init: function () {
                    this.on("complete", function (data) {
                        //var res = eval('(' + data.xhr.responseText + ')');
                        var res = JSON.parse(data.xhr.responseText);
                    });
                }
            };

        };

        // end pagefunction

    </script>
}